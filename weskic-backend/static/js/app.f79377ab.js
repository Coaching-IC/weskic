(function(t){function e(e){for(var o,r,s=e[0],c=e[1],l=e[2],p=0,f=[];p<s.length;p++)r=s[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(o=!1)}o&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var o={},i={app:0},a=[];function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"12b1":function(t,e,n){},"21ab":function(t,e,n){"use strict";n("12b1")},"47dc":function(t,e,n){},"4ff5":function(t,e,n){"use strict";n("7a1d")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("e9c4"),n("d3b7");var o=n("2b0e"),i=n("2f62"),a=n("289d"),r=(n("5abe"),n("8c4f")),s=n("aced"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"toplevel"}},[n("div",{attrs:{id:"bg"}}),n("div",{attrs:{id:"app"}},[n("router-view")],1)])},l=[],u={name:"App",components:{}},p=u,f=(n("034f"),n("2877")),d=Object(f["a"])(p,c,l,!1,null,null,null),m=d.exports,g=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"box",attrs:{id:"box"}},[o("div",{attrs:{id:"skis"}}),o("div",{attrs:{id:"leftBox"}},[o("h1",{staticClass:"title"},[t._v("Réservation WESKIC")]),o("h2",{staticClass:"subtitle"},[t._v("Weekend Ski - Coaching IC")]),o("hr"),o("p",{staticClass:"text"},[t._v("Comme chaque année (hum hum 2020) le Coaching IC organise son inoubliable Weekend Ski. Et cette fois-ci on revient en force avec un jour de plus et un nouvel endroit !")]),o("br"),o("div",{staticClass:"is-flex actionbar"},[o("b-button",{attrs:{type:"is-outlined",expanded:"",tag:"router-link",to:{name:"what"}}},[t._v("Informations")]),o("b-button",{attrs:{type:"is-info",expanded:"",tag:"a"},on:{click:t.loginWithTequila}},[t._v("Connexion")])],1)]),t._m(0),o("img",{attrs:{id:"logoCoaching",src:n("7560")}})])},b=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"is-flex-grow-1"},[n("div",{attrs:{id:"sideImage"}})])}],h=n("5530"),v={name:"LoginView",props:[],methods:Object(h["a"])({},Object(i["b"])(["loginWithTequila"]))},_=v,y=(n("4ff5"),Object(f["a"])(_,g,b,!1,null,"443c76ff",null)),w=y.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"topWhat"}},[n("b-button",{attrs:{id:"loginTop",type:"is-info is-large",tag:"router-link",to:{name:"login"}}},[t._v("Connexion")]),t._m(0),n("b-button",{attrs:{type:"is-success",tag:"router-link",to:{name:"login"}}},[t._v("J'adore, je fonce m'inscrire")])],1)},j=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box",attrs:{id:"box"}},[n("h1",{staticClass:"title"},[t._v("C'est quoi WESKIC ??")])])}],C={name:"WhatView",props:{}},S=C,k=(n("21ab"),Object(f["a"])(S,x,j,!1,null,"240a0ca7",null)),O=k.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box"},[n("div",{attrs:{id:"subbox"}},[n("h1",{staticClass:"title"},[t._v("Page introuvable")]),n("b-button",{attrs:{type:"is-primary",tag:"router-link",to:{name:"welcome"}}},[t._v("Retour à l'accueil")])],1)])},I=[],E={name:"NotFoundView",props:{}},T=E,P=(n("aa5e"),Object(f["a"])(T,q,I,!1,null,"2a33094e",null)),W=P.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"topWhat"}},[n("b-button",{attrs:{id:"loginTop",type:"is-warning is-outlined",tag:"router-link",to:{name:"logout"}}},[t._v("Déconnexion ")]),n("div",{staticClass:"box container",attrs:{id:"box"}},[n("b-steps",{attrs:{animated:"",rounded:"","has-navigation":"","mobile-mode":"minimalist"},model:{value:t.activeStep,callback:function(e){t.activeStep=e},expression:"activeStep"}},[n("b-step-item",{attrs:{step:"1",label:"Informations personelles",clickable:""}},[n("h1",{staticClass:"title has-text-centered"},[t._v("Account")]),t._v(" Lorem ipsum dolor sit amet. ")]),n("b-step-item",{attrs:{step:"2",label:"Profile",clickable:""}},[n("h1",{staticClass:"title has-text-centered"},[t._v("Profile")]),t._v(" Lorem ipsum dolor sit amet. ")]),n("b-step-item",{attrs:{step:"3",label:"Vérification d'identité",clickable:""}},[n("h1",{staticClass:"title has-text-centered"},[t._v("Social")]),t._v(" Lorem ipsum dolor sit amet. ")]),n("b-step-item",{attrs:{step:"4",label:"Paiement",clickable:""}},[n("h1",{staticClass:"title has-text-centered"},[t._v("Social")]),t._v(" Lorem ipsum dolor sit amet. ")])],1)],1)],1)},D=[],R={name:"WhatView",data:function(){return{activeStep:0}},props:{}},$=R,J=(n("cd54"),Object(f["a"])($,L,D,!1,null,"5bfb390f",null)),V=J.exports;o["a"].config.productionTip=!1,o["a"].use(a["a"]),o["a"].use(r["a"]),o["a"].use(i["a"]);var A=new i["a"].Store({state:{jwt:localStorage.getItem("jwt")||"",tequilaData:JSON.parse(localStorage.getItem("tequilaData"))||{}},mutations:{loggedIn:function(t,e){var n=e.jwt,o=e.tequilaData;t.jwt=n,t.tequilaData=o,localStorage.setItem("jwt",n),localStorage.setItem("tequilaData",JSON.stringify(o))},logout:function(t){t.jwt="",t.tequilaData={},localStorage.clear()}},actions:{loginWithTequila:function(){fetch("/api/tequila/request").then((function(t){return t.json()})).then((function(t){t.tequilaUrl&&(window.location=t.tequilaUrl)})).catch((function(t){console.error("Failed to reach the API",t),s["a"].open({message:"Failed to reach the API",type:"is-danger",position:"is-top"})}))}}});function U(t,e,n){t.query.key||n({name:"welcome"}),fetch("/api/tequila/login",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({key:t.query.key})}).then((function(t){return t.json()})).then((function(t){if(!0===t["success"])A.commit("loggedIn",t),M.push({name:"registration"});else if("ERR_LIST"===t["error"])s["a"].open({message:"Votre section n'est pas autorisée à s'inscrire à cet événement. Si vous pensez qu'il sagit d'une erreur, conectactez le comité du Coaching IC",type:"is-danger",position:"is-top"});else{if(t["error"]&&t["date"]){var e=new Date(t["date"]);console.log(t);var n=e.toLocaleString("fr-FR",{weekday:"long",month:"long",day:"numeric"});s["a"].open({message:"Tu ne peux pas encore t'inscrire, pour ta section c'est à partir du ".concat(n),type:"is-warning",position:"is-top",indefinite:!0})}else t["ERR_LIST"]?s["a"].open({message:"Ta section n'est pas conviée à cet événement. Désolé :/",type:"is-warning",position:"is-top",indefinite:!0}):"ERR_TEQUILA"===t["error"]?s["a"].open({message:"L'authentifcation Tequila a échoué",type:"is-danger",position:"is-top"}):s["a"].open({message:"Une erreur inconnue est survenue",type:"is-danger",position:"is-top"});M.push({name:"login"})}console.log(t)})).catch((function(t){console.error(t),s["a"].open({message:"Une erreur serveur est survenue",type:"is-danger",position:"is-top"})}))}var F=[{path:"/",redirect:{name:"what"}},{path:"/what-is-weskic",component:O,name:"what"},{path:"/login",component:w,name:"login",beforeEnter:function(t,e,n){""!==A.state.jwt?n({name:"registration"}):n()}},{path:"/not-found",component:W,name:"not-found"},{path:"/tequila",beforeEnter:U},{path:"/registration",component:V,name:"registration",beforeEnter:function(t,e,n){""===A.state.jwt?n({name:"login"}):n()}},{path:"/logout",name:"logout",beforeEnter:function(t,e,n){console.log("logging out ..."),A.commit("logout"),n({name:"login"})}},{path:"/*",redirect:{name:"not-found"}}],M=new r["a"]({routes:F,mode:"history"});new o["a"]({router:M,store:A,render:function(t){return t(m)}}).$mount("#app")},7560:function(t,e,n){t.exports=n.p+"img/logo-full.60411e3a.png"},"7a1d":function(t,e,n){},"85ec":function(t,e,n){},aa5e:function(t,e,n){"use strict";n("47dc")},b622f:function(t,e,n){},cd54:function(t,e,n){"use strict";n("b622f")}});
//# sourceMappingURL=app.f79377ab.js.map